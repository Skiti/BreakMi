"""
constants.py

"""

SEED_BYTES = 16  # Bytes
CHAL_BYTES = 16  # Bytes
RESP_BYTES = 16  # Bytes
PAIR_KEY_BYTES = 16  # Bytes
BTADD_LEN = 6  # Bytes, 48 bits

MB45_PUB_KEY_HEXSTR = '1863c2cce5d159413bed92c4b163c279'
MB45_PUB_KEY = bytearray.fromhex(MB45_PUB_KEY_HEXSTR)
assert(len(MB45_PUB_KEY) == 16)

MB45_PUB_KEY_SHA1 = b"TODO"


# NOTE: ATT
ATT_PAIR_UUID128 = '00:00:00:09:00:00:35:12:21:18:00:09:af:10:07:00'
ATT_FWUP_SER_UUID128 = '00:00:15:30:00:00:35:12:21:18:00:09:af:10:07:00'

# NOTE: display filters
# btatt.service_uuid128 == 00:00:15:30:00:00:35:12:21:18:00:09:af:10:07:00 or
# btatt.uuid128 == 00:00:00:09:00:00:35:12:21:18:00:09:af:10:07:00
DF_ATT = {
    'PAIR_UUID128': f'btatt.uuid128 == {ATT_PAIR_UUID128}',
    'FWUP_SER_UUID128': f'btatt.service_uuid128 == {ATT_FWUP_SER_UUID128}',
}

DF_HCI_CMD = {
    'LE_START_ENC':  'bthci_cmd.opcode == 0x2019',
}

FW_MB3_BEGIN = '0080fc074141000801b4fc0719b4fc0700000000'
FW_MB3_BEGIN_INT = int(FW_MB3_BEGIN, 16)
FW_MB3_END = '484d52455331'
FW_MB3_END_INT = int(FW_MB3_END, 16)

FW_MB45_BEGIN = '5171'
FW_MB45_BEGIN_INT = int(FW_MB45_BEGIN, 16)
FW_MB45_BEGIN2034 = '312e302e302e31'
FW_MB45_BEGIN2034_INT = int(FW_MB45_BEGIN2034, 16)
FW_MB45_HMFWSIGN = '484d46575349474e'
FW_MB45_HMFWSIGN_INT = int(FW_MB45_HMFWSIGN, 16)

